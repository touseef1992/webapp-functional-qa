{% extends "base.html" %}
{% block title %}Dashboard ‚Äî Demo Web App{% endblock %}

{% block content %}
<main class="page-container">
  <header class="page-header">
    <div class="page-title-block">
      <h1 class="page-title">Dashboard</h1>
      <p class="page-sub">Overview</p>
    </div>
    <div class="page-meta" aria-hidden="true">
      <div class="signed-in">Signed in as <strong>{{ current_user.email if current_user and current_user.is_authenticated else 'guest@example.com' }}</strong></div>
    </div>
  </header>

  <!-- summary cards -->
  <section class="cards-row" role="region" aria-label="Overview">
    <div class="card card-small">
      <div class="card-label">Total Users</div>
      <div class="card-value">{{ stats.total_users or 3 }}</div>
    </div>
    <div class="card card-small">
      <div class="card-label">Active Sessions</div>
      <div class="card-value">{{ stats.active_sessions or 4 }}</div>
    </div>
    <div class="card card-small">
      <div class="card-label">Signups Today</div>
      <div class="card-value">{{ stats.signups_today or 2 }}</div>
    </div>
    <div class="card card-small">
      <div class="card-label">Open Issues</div>
      <div class="card-value">{{ stats.open_issues or 5 }}</div>
    </div>
  </section>

  <!-- main grid -->
  <section class="grid">

    <!-- left column: user sessions map (donut) -->
    <article class="panel panel-large" aria-labelledby="sessions-heading">
      <h2 id="sessions-heading" class="panel-title">User Sessions Map</h2>

      <div class="panel-body">
        <div class="donut-wrapper" role="img" aria-label="User sessions distribution by region">
          <!-- SVG donut (static) -->
          <svg id="sessionsDonut" viewBox="0 0 200 200" width="260" height="260" aria-hidden="true" focusable="false">
            <!-- background circle -->
            <circle cx="100" cy="100" r="80" fill="transparent" stroke="rgba(255,255,255,0.03)" stroke-width="40"></circle>

            <!-- arcs: values are example; replace with Jinja loops if you generate dynamically -->
            <!-- North America slice (blue) -->
            <path d="M100,20 A80,80 0 0,1 177.3,77.1" fill="transparent" stroke="#3ea6ff" stroke-width="40" stroke-linecap="butt"></path>
            <!-- Europe slice (green) -->
            <path d="M177.3,77.1 A80,80 0 0,1 113.2,173.4" fill="transparent" stroke="#2ecc71" stroke-width="40" stroke-linecap="butt"></path>
            <!-- India slice (yellow) -->
            <path d="M113.2,173.4 A80,80 0 0,1 76.0,158.1" fill="transparent" stroke="#f1c40f" stroke-width="40" stroke-linecap="butt"></path>
            <!-- SEA slice (pink) -->
            <path d="M76.0,158.1 A80,80 0 0,1 100,20" fill="transparent" stroke="#ff7fa3" stroke-width="40" stroke-linecap="butt"></path>
          </svg>

          <!-- Safe, static center label ‚Äî purely presentational -->
          <div class="donut-center-text" role="presentation" aria-hidden="true">
            <div class="label">Sessions</div>
            <div class="value">{{ stats.total_sessions or 32 }}</div>
          </div>
        </div>

        <!-- legend on the right (keeps layout predictable) -->
        <div class="donut-legend" aria-hidden="false" role="list">
          <div class="legend-item" role="listitem"><span class="legend-swatch" style="background:#3ea6ff" aria-hidden="true"></span> North America <span class="legend-value">14 <span class="legend-percent">(44%)</span></span></div>
          <div class="legend-item" role="listitem"><span class="legend-swatch" style="background:#2ecc71" aria-hidden="true"></span> Europe <span class="legend-value">10 <span class="legend-percent">(31%)</span></span></div>
          <div class="legend-item" role="listitem"><span class="legend-swatch" style="background:#f1c40f" aria-hidden="true"></span> India <span class="legend-value">6 <span class="legend-percent">(19%)</span></span></div>
          <div class="legend-item" role="listitem"><span class="legend-swatch" style="background:#ff7fa3" aria-hidden="true"></span> SEA <span class="legend-value">2 <span class="legend-percent">(6%)</span></span></div>
        </div>
      </div>

      <footer class="panel-footer">
        <div class="device-badges">
          <span class="device">üñ•Ô∏è Desktop <strong>18</strong></span>
          <span class="device">üì± Mobile <strong>12</strong></span>
          <span class="device">üìü Tablet <strong>2</strong></span>
        </div>
      </footer>
    </article>

    <!-- right column widgets -->
    <aside class="panel-right">
      <div class="panel panel-medium">
        <h3 class="panel-title">Page traffic (7 days)</h3>
        <div class="panel-body">
          <!-- Placeholder / lightweight chart box -->
          <div class="mini-chart" aria-hidden="true">
            <!-- simple decorative svg: keeps UI clean without external libs -->
            <svg width="220" height="100" viewBox="0 0 220 100" preserveAspectRatio="none" aria-hidden="true" focusable="false">
              <rect x="10" y="20" width="30" height="60" rx="6" fill="rgba(62,166,255,0.12)"></rect>
              <rect x="50" y="28" width="30" height="52" rx="6" fill="rgba(62,166,255,0.16)"></rect>
              <rect x="90" y="15" width="30" height="65" rx="6" fill="rgba(62,166,255,0.14)"></rect>
              <rect x="130" y="24" width="30" height="56" rx="6" fill="rgba(62,166,255,0.12)"></rect>
              <rect x="170" y="12" width="30" height="68" rx="6" fill="rgba(62,166,255,0.18)"></rect>
            </svg>
          </div>
        </div>
      </div>

      <div class="panel panel-medium">
        <h3 class="panel-title">Browsers</h3>
        <div class="panel-body">
          <ul class="browser-list" aria-hidden="false">
            <li>Chrome <span class="bar" style="width:47%"></span><strong class="pct">47%</strong></li>
            <li>Firefox <span class="bar" style="width:25%"></span><strong class="pct">25%</strong></li>
            <li>Edge <span class="bar" style="width:16%"></span><strong class="pct">16%</strong></li>
            <li>Safari <span class="bar" style="width:12%"></span><strong class="pct">12%</strong></li>
          </ul>
        </div>
      </div>
    </aside>
  </section>

  <!-- activity + recent signups -->
  <section class="grid-bottom">
    <div class="panel panel-medium">
      <h3 class="panel-title">Activity</h3>
      <div class="panel-body">
        <ul class="activity-list">
          <li><strong>New signup</strong> ‚Äî alice@example.com <div class="meta">2025-12-12 16:55</div></li>
          <li><strong>Login</strong> ‚Äî test1@example.com <div class="meta">2025-12-12 16:07</div></li>
          <li><strong>Failed login</strong> ‚Äî unknown@example.com <div class="meta">2025-12-12 15:07</div></li>
        </ul>
      </div>
    </div>

    <div class="panel panel-medium">
      <h3 class="panel-title">Recent signups</h3>
      <div class="panel-body">
        <table class="recent-table" role="table" aria-label="Recent signups">
          <thead><tr><th>Email</th><th>When</th></tr></thead>
          <tbody>
            <tr><td>alice@example.com</td><td>2025-12-12 16:55</td></tr>
            <tr><td>test1@example.com</td><td>2025-12-12 16:07</td></tr>
            <tr><td>unknown@example.com</td><td>2025-12-12 15:07</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </section>
</main>
{% endblock %}
